# 嵌入式软件系统

## 嵌入式软件系统概述

这一部分可以参考[软件工程概述部分](..\软件工程\软件工程简介.md)

一种逻辑实体，具有抽象性

软件没有明显制作过程

使用过程中，没有磨损、老化的问题

对环境有不同程度的依赖性，导致了软件移植问题

### 特点

- 规模小，开发难度大
  - 软件包括板级初始化程序（BSP）、驱动程序、嵌入式操作系统、应用程序、测试程序
- 快速启动，直接运行
- 实时性和可靠性要求高
- 程序一体化
  - 应用程序和操作系统，一体化程序
- 两个平台
  - 开发平台，运行平台

## 嵌入式软件系统的分类

系统软件：控制、管理计算机系统的资源

支持软件：辅助软件开发的工具，（国标将中间件划分在这里，与教材不同）

应用软件：面向应用领域

从运行平台来分

- 运行在开发平台上的软件
- 运行在嵌入式系统上的软件：SOC，应用程序、驱动程序及部分开发工具

## 嵌入式软件系统的体系结构

应用层

中间件层

​	CORBA，JAVA，DCOM，面向应用领域的中间件

操作系统层

驱动层

- 板级初始化程序

  微处理器、存储器、中断控制器、DMA、定时器的初始化

- 与系统软件相关的驱动

  一般与系统绑定

- 与应用软件相关的驱动

硬件

## 运行流程

板级初始化

- 上电复位
  - CPU中堆栈指针寄存器的初始化
  - BSS段

系统引导/升级阶段

​	引导方式

- NOR Flash读取加载到RAM中

- 不需要引导到RAM直接在NorFlash，进入系统初始化

- 软件从外存中读取出来加载到RAM中运行

  升级阶段

- 远程升级，本地升级

应用初始化

​	应用任务的创建，信号量、消息队列的创建

多任务应用运行阶段

## 嵌入式操作系统的演变

### 概述

嵌入式操作系统是应用在嵌入式系统的操作系统，具有一般操作系统的功能，同时具有嵌入式软件的特点

- 可固化
- 可配置、可裁剪
- 独立的板级支持包，可修改
- 不同的CPU有不同的版本
- 应用的开发需要有集成交叉开发工具

无操作系统：基于单片机

简单操作系统：简单内核

实时操作系统：嵌入式实时多任务操作系统RTOS，具备多任务内核外，包括嵌入式文件、设备管理、嵌入式TCP/IP、嵌入式GUI等

RTOS举例

​	VRTX，VxWorks，QNX，TinyOS，μcOS-II，TRLinux，eCos，Android，IOS

### 分类

从应用领域来分

- SymbianOS、MS MobileOS，PalmOS、Embedded Linux，OSEK/AUTOSAR

从实时性的角度来分

- VxWorks、QNX、Nuclear、OSE、DeltaOS（国产嵌入式OS）、ITRON OS
- WinCE，众多嵌入式Linux，PalmOS

商业模式

- 商业型：功能稳定...、开发费用+版税
- 开源型

### 体系结构

目前：

- 宏内核（单块结构）
  - 操作系统由多种模块构成
  - 模块之间可相互调用
  - 用户态和核心态两种工作模式
  - 两种执行权限和执行空间
- 层次结构