# 文件

## 文件和文件系统

文件结构

1. 字段：基本数据单位，用于描述对象某种属性，每个字段都具有一样高唯一值
2. 记录：是一组相关字段的集合，是应用程序可处理数据单位
3. 文件：文件是若干相关记录的集合

非结构数据库 MongoDB/HDFS/

文件系统：操作系统中各类文件、管理文件的软件，管理文件涉及到数据结构等信息的集合

少数文件系统从操作系统中分离出来，独立于操作系统存在，绝大多数操作系统都包含文件系统部分。

文件系统设计目标

- 有效地组织管理文件
- 提供方便的用户接口

文件系统模型

用户（程序）-->文件系统接口 --> 对对象操作和管理的软件集合 -->对象及其属性

屏蔽底层数据的不同特点，HAL 硬件抽象层（Hardware Abstraction Layer）

| 文件系统实现模型 | 描述                                                         |
| ---------------- | ------------------------------------------------------------ |
| 文件系统接口     | 命令、系统、调用和图像窗口                                   |
| 逻辑功能层       | 访问存储介质的物理参数，形成响应的驱动命令，启动实施IO操作   |
| 物理驱动层       | 将逻辑功能层发下的命令转化为相应的驱动程序，完成文件物理存储设备的处理 |

- 对象及其属性 文件、文件目录、外部存储设备
- 管理软件的集合 存储空间、目录、地址映射、共享保护
- 文件系统接口 命令、系统调用

文件系统与数据库管理系统区别与联系

1. 数据库管理系统中定义的各种数据结构对人家系统透明，文件系统只处理**无结构、无格式**的字节流
   - 关系型数据库 非结构化数据库 NoSQL
     - SQL(结构化查询语言) 
     - BigData 大部分属于非关系型数据 非结构化
       - MongoDB HBase
   - 文件系统给数据库管理提供“记录——流转换”接口
   - 无论文件系统是在操作系统中还是操作系统上，数据库管理系统DBMS过于依赖文件系统都需要构建在文件系统之上。这种数据库性能不高
2. 为了提高数据库性能，数据库管理系统不依赖于操作系统提供的文件系统，独立的数据组织及存取机制，直接操纵文件存储设备，存储管理程序大多能提供一些低级接口

:stop_button:漏

文件分类

- 系统文件、用户文件、库文件
- 源文件、目标文件、可执行文件
- 只读、读写、执行
- 普通文件、目录文件..:stop_button:

## 文件的逻辑结构

- 逻辑结构
  - 用户的观点
    - 顺序
    - 索引
  - 独立于物理特性
- 物理结构
  - 系统的观点 硬件
    - 空闲空间
    - 占用空间
  - 具体物理组织形式
- 两种结构都会影响文件的检索速度

### 文件逻辑结构

- 有结构文件
  - 一系列记录组成
  - 记录可以是定长，也可以是变长
  - 记录的组织形式
    - 顺序
    - 索引
    - 顺序索引
- 无结构文件
  - 流式文件
- 半结构
  - 异步加载的网页

结构化文件与流文件的联系：硬件都块设备，所以需要进行流到块的转换

## 有结构文件的结构

#### 顺序文件

逻辑顺序

串结构，记录之间的顺序与关键字无关。通常方法由世界来决定，存入世界的先后排列。

顺序结构，文件中:stop_button:

顺序文件(Sequential File)读写操作

定长和变长记录文件

#### 索引文件

索引表

#### 索引顺序

字典索引查找，按种类分类，按顺序查找

#### 哈希

直接文件 hash文件

## 磁盘存储器的管理

部分内容包含在内存管理章节里面

- 分配单位是磁盘块
  - 连续分配方式
  - 离散分配方式
- 实现存储空间分配，
- 空闲分区表
  - 号 起始 结束
- 空闲分区链
  - head 指向 起始点|长度|指针

- 分区分配
  - 最佳（有序，从小到大排列）
  - 最坏（有序，从小到大排列）
  - 首次适应(地址从低到高)
  - 循环首次适应(地址从低到高)

### 位示图

